<html>
    <head>
        <title>World populaion density</title>
        <script type="text/javascript" async src="http://www.google-analytics.com/ga.js"></script>
        <script type="text/javascript" src="js/three.min.js"></script>
        <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    </head>
    <body>
        <h1 class="page-header">
            World Population Density 2010
        <h1>
        <div id="globe">
            <canvas width="1000" height="600">
        </div>

        <script type="text/javascript">
            //camera/light pos and screen dimensions
            var POS_X = 1800,
                POS_Y = 500,
                POS_Z = 1800,
                WIDTH = 1000,
                HEIGHT = 600;

            //camera params
            var FOV = 45,
                NEAR = 1,
                FAR = 4000;

            var renderer = new THREE.WebGLRenderer();
            renderer.setSize(WIDTH, HEIGHT);
            renderer.setClearColorHex(0x111111);

            var mapDiv = document.getElementById("globe");
            mapDiv.appendChild(renderer.domElement);

            var camera = new THREE.PerspectiveCamera(FOV, WIDTH/HEIGHT, NEAR, FAR);
            camera.position.set(POS_X, POS_Y, POS_Z);
            camera.lookAt(new THREE.Vector3(0,0,0));

            var scene = new THREE.Scene();
            scene.add(camera);

            function addEarth() {
                var spGeo = THREE.SphereGeometry(600, 50, 50);
                var planetTexture = THREE.ImageUtils.loadTexture('static/images/bathy.jpg');
                var mat2 = new THREE.MeshPhongMaterial( {
                    map: planetTexture,
                    shininess: 0.2 });
                sp = new THREE.Mesh(spGeo, mat2);
                scene.add(sp);
            }

            function addLights() {
                light = new THREE.DirectionalLight(0x3333ee, 3.5, 500);
                scene.add(light);
                light.position.set(POS_X, POS_Y, POS_Z);
            }

            $(document).ready(function() {
                jQuery.get('data/density.csv', function(data) {
                    addDensity(CSVToArray(data));
                    addLights();
                    addEarth();
                    render();
                });
            });
        </script>
    </body>
</html>